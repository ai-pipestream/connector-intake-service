# Test configuration
quarkus.application.name=connector-intake-service-test

# Avoid HTTP port conflicts in tests
quarkus.http.test-port=0
quarkus.http.port=0

# Database for tests (MySQL DevServices)
quarkus.datasource.db-kind=mysql
quarkus.datasource.devservices.enabled=true
quarkus.datasource.devservices.image-name=mysql:8.0
quarkus.datasource.devservices.port=0
quarkus.datasource.devservices.show-logs=true
quarkus.datasource.devservices.reuse=false
quarkus.datasource.devservices.container-env.MYSQL_DATABASE=pipeline_connector_intake_test
# Ensure credentials align with DevServices defaults
quarkus.datasource.username=quarkus
quarkus.datasource.password=quarkus

# Use Flyway migrations for schema
quarkus.hibernate-orm.schema-management.strategy=none
quarkus.flyway.migrate-at-start=true
quarkus.flyway.clean-at-start=false

# ======================================================================================================================
# WireMock Dev Service Configuration
# ======================================================================================================================
quarkus.wiremock.devservices.enabled=true
quarkus.wiremock.devservices.extension-scanning-enabled=true
quarkus.wiremock.devservices.files-mapping=classpath:META-INF
quarkus.wiremock.devservices.global-response-templating=true

# Point repository-service client to WireMock
# Note: This will be set by RepositoryServiceWireMockTestBase, but we can also set a default here
# quarkus.grpc.clients.NodeUploadService.port=${quarkus.wiremock.devservices.port}
